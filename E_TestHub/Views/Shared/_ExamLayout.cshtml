<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"] - eTestHub</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <link href="~/css/shared/exam-layout.css" rel="stylesheet">
    @RenderSection("Styles", required: false)
</head>
<body class="exam-mode">
    @{
        var userName = Context.Session.GetString("UserName") ?? "User";
        var userRole = Context.Session.GetString("UserRole") ?? "Student";
    }

    <!-- Exam Header Bar -->
    <header class="exam-header-bar">
        <div class="exam-header-left">
            <div class="exam-brand">
                <i class="fas fa-graduation-cap"></i>
                <span class="brand-name">E_TestHub</span>
            </div>
            <div class="exam-divider"></div>
            <div class="exam-mode-badge">
                <i class="fas fa-pencil-alt"></i>
                <span>Đang làm bài</span>
            </div>
        </div>

        <div class="exam-header-right">
            <div class="exam-user-info">
                <i class="fas fa-user-circle"></i>
                <span>@userName</span>
            </div>
            <button class="exam-logout-btn" onclick="return confirm('Bạn có chắc muốn thoát? Bài thi sẽ không được lưu!');" 
                    title="Thoát khỏi bài thi">
                <i class="fas fa-sign-out-alt"></i>
                <span>Thoát</span>
            </button>
        </div>
    </header>

    <!-- Main Exam Content - Full Width -->
    <main class="exam-main-wrapper">
        @RenderBody()
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    @RenderSection("Scripts", required: false)

    <script>
        // Prevent accidental page leave during exam
        window.addEventListener('beforeunload', function (e) {
            e.preventDefault();
            e.returnValue = '';
            return 'Bạn có chắc muốn rời khỏi trang? Bài thi có thể không được lưu!';
        });

        // Disable right-click (optional - can be removed if not needed)
        // document.addEventListener('contextmenu', function(e) {
        //     e.preventDefault();
        // });

        // Fullscreen mode toggle (optional feature)
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log('Fullscreen not available');
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        // Auto-save function (can be implemented later)
        function autoSaveExam() {
            // TODO: Implement auto-save logic
            console.log('Auto-saving exam progress...');
        }

        // Auto-save every 30 seconds
        // setInterval(autoSaveExam, 30000);
    </script>
</body>
</html>
